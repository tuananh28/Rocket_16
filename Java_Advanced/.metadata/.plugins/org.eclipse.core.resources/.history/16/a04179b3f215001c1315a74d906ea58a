package com.vti.controller;

import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@CrossOrigin("*")
@RequestMapping(value = "/api/v1/resetpassword")
public class ResetPasswordController {


	@Autowired
	private IUserService userService;
	// reset password confirm
		@GetMapping("/resetPasswordRequest")
		// validate: email exists, email not active
		public ResponseEntity<?> sendResetPasswordViaEmail(@RequestParam String email) {

			userService.resetPasswordViaEmail(email);

			return new ResponseEntity<>("We have sent an email. Please check email to reset password!", HttpStatus.OK);
		}

		// resend reset password
		@GetMapping("/resendResetPassword")
		// validate: email exists, email not active
		public ResponseEntity<?> resendResetPasswordViaEmail(@RequestParam String email) {

			userService.sendResetPasswordViaEmail(email);

			return new ResponseEntity<>("We have sent an email. Please check email to reset password!", HttpStatus.OK);
		}

		@GetMapping("/resetPassword")
		// validate: check exists, check not expired
		public ResponseEntity<?> resetPasswordViaEmail(@RequestParam String token, @RequestParam String newPassword) {

			// reset password
			userService.resetPassword(token, newPassword);

			return new ResponseEntity<>("Reset Password success!", HttpStatus.OK);
		}

}
